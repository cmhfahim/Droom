{% extends "base.html" %}
{% load static %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="mb-4">Company Dashboard - {{ request.user.company.name }}</h2>
    <p>Welcome, {{ request.user.username }}!</p>

    <!-- Summary Cards -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card text-white bg-primary mb-3 shadow">
                <div class="card-body">
                    <h5 class="card-title">Employees</h5>
                    <p class="card-text display-6">{{ dashboard_data.employees|length }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-success mb-3 shadow">
                <div class="card-body">
                    <h5 class="card-title">Items</h5>
                    <p class="card-text display-6">{{ dashboard_data.items|length }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-warning mb-3 shadow">
                <div class="card-body">
                    <h5 class="card-title">Expenses</h5>
                    <p class="card-text display-6">{{ dashboard_data.expenses|length }}</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-info mb-3 shadow">
                <div class="card-body">
                    <h5 class="card-title">Materials</h5>
                    <p class="card-text display-6">{{ dashboard_data.materials|length }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Employees Table -->
    <h4>Employees</h4>
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>ID</th><th>Name</th><th>Age</th><th>Address</th>
                <th>Phone</th><th>Salary</th><th>Post</th>
            </tr>
        </thead>
        <tbody>
            {% for emp in dashboard_data.employees %}
            <tr>
                <td>{{ emp.id }}</td>
                <td>{{ emp.name }}</td>
                <td>{{ emp.age }}</td>
                <td>{{ emp.address }}</td>
                <td>{{ emp.phone }}</td>
                <td>{{ emp.salary }}</td>
                <td>{{ emp.post }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="7" class="text-center">No employees found.</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Items Table -->
    <h4 class="mt-5">Items</h4>
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>ID</th><th>Buying Price</th><th>Selling Price</th>
                <th>Total Quantity</th><th>Total Cost</th><th>Remain</th>
            </tr>
        </thead>
        <tbody>
            {% for item in dashboard_data.items %}
            <tr>
                <td>{{ item.id }}</td>
                <td>{{ item.buying_price }}</td>
                <td>{{ item.selling_price }}</td>
                <td>{{ item.total_quantity }}</td>
                <td>{{ item.total_cost }}</td>
                <td>{{ item.remain }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="6" class="text-center">No items found.</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Expenses Table -->
    <h4 class="mt-5">Expenses</h4>
    <table class="table table-striped table-bordered">
        <thead>
            <tr><th>ID</th><th>Date</th><th>Type</th><th>Item</th><th>Total</th></tr>
        </thead>
        <tbody>
            {% for exp in dashboard_data.expenses %}
            <tr>
                <td>{{ exp.id }}</td>
                <td>{{ exp.date }}</td>
                <td>{{ exp.type }}</td>
                <td>{{ exp.item_id }}</td>
                <td>{{ exp.total }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="5" class="text-center">No expenses found.</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Materials Table -->
    <h4 class="mt-5">Materials Expenses</h4>
    <table class="table table-striped table-bordered">
        <thead>
            <tr><th>Type</th><th>Date</th><th>Cost</th><th>Item</th></tr>
        </thead>
        <tbody>
            {% for mat in dashboard_data.materials %}
            <tr>
                <td>{{ mat.type }}</td>
                <td>{{ mat.date }}</td>
                <td>{{ mat.cost }}</td>
                <td>{{ mat.item_id }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="4" class="text-center">No materials expenses found.</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Operations Table -->
    <h4 class="mt-5">Operational Expenses</h4>
    <table class="table table-striped table-bordered">
        <thead>
            <tr><th>Type</th><th>Date</th><th>Cost</th></tr>
        </thead>
        <tbody>
            {% for op in dashboard_data.operations %}
            <tr>
                <td>{{ op.type }}</td>
                <td>{{ op.date }}</td>
                <td>{{ op.cost }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="3" class="text-center">No operational expenses found.</td></tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Stock Dashboard -->
    <h4 class="mt-5">Stock Dashboard</h4>
    <table class="table table-striped table-bordered">
        <thead><tr><th>Item</th><th>Remaining</th></tr></thead>
        <tbody>
            {% for d in dashboard_data.stock %}
            <tr>
                <td>{{ d.item_id }}</td>
                <td>{{ d.remaining }}</td>
            </tr>
            {% empty %}
            <tr><td colspan="2" class="text-center">No stock data available.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
